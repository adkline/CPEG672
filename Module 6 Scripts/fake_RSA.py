import random, binascii
from Crypto.Util.number import *

(n,e) =(22301182751614905210260457834437519738025683753765625449133732102727648945357459691464687155866993828381791997832622804475980020805214377221870911967567023692825889893628572130736940827964726555145103439676961277210169070884577705216726128661414929043919767526951334578694775084604647961403560315231214725803536904677192974238192822117752645546856515525870529129367204200616122947351127407352372328275495701189078034301716419293581821157715504069231169820989698836082368560768238344948555863632864289505412537539335399987080485078739912635478620155326307951940922306987412734237149388249882110002086616146645599602259 , 65537)



sigma = 21458635307593614076865841927447384395279223019563183611443005338715605140691099408052402001728426246822475658372699523500944955134719546270640744208284344227677605472173196622476542278775515501171772891816612889502529257167426479581456427063041685989943592290723915406209400321978480331533652272527014208407469923528580656695399099980869363613479096981336765137577114469032949598468364937297605117564465312601631129605435317243976310264818408095333240494204682760138330010525247131522471318159518647828801436425122424965904620419469936978380129247628720889285709990518798831281098762838045009133527524689995723301416


sig_prime = getRandomRange(1,n)

while GCD(sig_prime, n) != 1:
    sig_prime = getRandomRange(1,n) 



M_prime = pow(sig_prime,e,n)

print M_prime
m = "I, the undersigned, do solemnly swear to pick boogers, eat them, and wipe any excess on my shirt."
m_hex = binascii.hexlify(m)



pub_key = 26555818315545122301751077409629760500790210636296793926879845240069872644050318548968747450975923374086618133646202779328212405546865480653303590632169334112878633669624512229297696797360067756813978948205570051552263127846544972571287276960030031994746497707882240313288768903519594589104516126968527171676366450738215301668502277433014417584892914597589136316743029303210499962554092428395742206395738107309626685196600750144684648963103253218768736759994227331026666424455363286772554192011373369892846246879200485731555242824742067999927217639857625760336477346836832273663065853301031265586567985935942565879131
m_int = int(m_hex,16)

### find number between 1, n 
m1 = getRandomRange(1,pub_key)
while GCD(m1, pub_key) != 1:
    m1 = getRandomRange(1,pub_key) 
    
print m1

print m_int/m1